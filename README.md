# Домашнее задание: Микросервисы — принципы Перцев Максим

В рамках задания нужно было предложить инфраструктурные решения для микросервисной системы:
- выбрать API Gateway  
- выбрать брокер сообщений  
- обосновать выбор

---

## Задача 1: API Gateway

API Gateway — это единая точка входа для всех клиентов, через которую идут запросы к микросервисам.

### Основные требования:
- маршрутизация запросов к нужному сервису  
- проверка авторизации (например JWT, API key)  
- поддержка HTTPS (терминация TLS)  

### Сравнение решений

| Решение | Маршрутизация | Аутентификация | HTTPS | Комментарий |
|--------|----------------|----------------|-------|-------------|
| NGINX | Да | Частично | Да | Хороший proxy, но не полноценный gateway |
| Traefik | Да | Частично | Да | Удобен в Docker/Kubernetes |
| **Kong** | Да | Да | Да | Много готовых плагинов, удобно для микросервисов |
| HAProxy | Да | Сложно | Да | Больше про балансировку |
| Envoy | Да | Да | Да | Очень мощный, но сложный в настройке |

### Выбор
Я выбрал **Kong Gateway**.

### Обоснование
- Kong изначально создавался именно как API Gateway  
- Есть готовые плагины для авторизации (JWT, OAuth2, API key)  
- Удобно настраивать маршруты и политики безопасности  
- Поддерживает HTTPS без дополнительных костылей  
- Хорошо подходит для микросервисной архитектуры, где важно централизованно управлять доступом

---

## Задача 2: Брокер сообщений

Брокер сообщений нужен для асинхронного взаимодействия между сервисами.

### Требования:
- поддержка кластеризации  
- хранение сообщений на диске  
- высокая производительность  
- поддержка разных форматов  
- возможность разграничивать доступ  
- разумная сложность эксплуатации  

### Сравнение брокеров

| Брокер | Кластер | Хранение | Скорость | Удобство эксплуатации |
|--------|--------|----------|----------|------------------------|
| RabbitMQ | Да | Да | Средняя | Проще для начала |
| **Kafka** | Да | Да | Высокая | Чуть сложнее, но мощнее |
| NATS | Да | Да | Высокая | Лёгкий и быстрый |
| ActiveMQ | Да | Да | Средняя | Используется реже |

### Выбор
Я выбрал **Apache Kafka**.

### Обоснование
- Kafka хорошо масштабируется горизонтально  
- Сообщения хранятся на диске, их можно перечитывать  
- Очень высокая производительность  
- Поддерживает любые форматы сообщений (JSON, Avro, Protobuf и т.д.)  
- Есть ACL для разграничения доступа между сервисами  
- Часто используется в крупных системах и считается стандартом для event streaming

---

## Итоговое решение

Для микросервисной архитектуры предлагаю:
- **API Gateway:** Kong Gateway  
- **Брокер сообщений:** Apache Kafka  

Такое решение:
- масштабируется  
- подходит для реальных production-систем  
- закрывает все требования задания  
- используется в индустрии

---


